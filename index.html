<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Chameleon by JJaraM</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Chameleon</h1>
        <p></p>

        <p class="view"><a href="https://github.com/JJaraM/chameleon">View the Project on GitHub <small>JJaraM/chameleon</small></a></p>


        <ul>
          <li><a href="https://github.com/JJaraM/chameleon/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/JJaraM/chameleon/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/JJaraM/chameleon">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><img src="https://github.com/JJaraM/Chameleon/blob/master/logo.png" alt="logo"></p>

<h1>
<a id="what-is-chameleon" class="anchor" href="#what-is-chameleon" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>What is Chameleon?</h1>

<p>Is a java framework that helps the copy objects that have the same attributes types, without the necessity to create heavy factories and deal with the creation of the subrelations objects. </p>

<h1>
<a id="problem-to-attack" class="anchor" href="#problem-to-attack" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Problem to attack</h1>

<p>For example <strong>Chameleon</strong> will prevent this.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">CarFactory</span> {

     <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">CarFactory</span> instance <span class="pl-k">=</span> <span class="pl-c1">null</span>;

     <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">CarFactory</span> <span class="pl-en">getInstance</span>() {
          <span class="pl-k">if</span> (instance <span class="pl-k">==</span> <span class="pl-c1">null</span>) {
               instance <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">CarFactory</span>();
          }
          <span class="pl-k">return</span> instance;
     }

     <span class="pl-k">public</span> <span class="pl-smi">CarDTO</span> <span class="pl-en">create</span>(<span class="pl-smi">Car</span> <span class="pl-v">car</span>) {
          <span class="pl-smi">Motor</span> motor <span class="pl-k">=</span> <span class="pl-smi">MotorFactory</span><span class="pl-k">.</span>getInstance()<span class="pl-k">.</span>create(car<span class="pl-k">.</span>getMotor()); <span class="pl-c">// First factory created because we have a relation</span>
          <span class="pl-smi">MotorDTO</span> motorDTO <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">MotorDTO</span>(); <span class="pl-c">// Object from relation</span>
          motorDTO<span class="pl-k">.</span>setId(motor<span class="pl-k">.</span>getId());
          <span class="pl-smi">CarDTO</span> carDTO <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">CarDTO</span>(); 
          carDTO<span class="pl-k">.</span>setModel(car<span class="pl-k">.</span>getModel()); 
          carDTO<span class="pl-k">.</span>setYear(car<span class="pl-k">.</span>getYear());
          carDTO<span class="pl-k">.</span>setMotor(motorDTO);
          <span class="pl-k">return</span> carDTO;
     }
}</pre></div>

<p>Representation of MotorFactory class.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">MotorFactory</span> {

     <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">MotorFactory</span> instance <span class="pl-k">=</span> <span class="pl-c1">null</span>;

     <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">MotorFactory</span> <span class="pl-en">getInstance</span>() {
          <span class="pl-k">if</span> (instance <span class="pl-k">==</span> <span class="pl-c1">null</span>) {
               instance <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">MotorFactory</span>();
          }
          <span class="pl-k">return</span> instance;
     }

     <span class="pl-k">public</span> <span class="pl-smi">MotorDTO</span> <span class="pl-en">create</span>(<span class="pl-smi">Motor</span> <span class="pl-v">motor</span>) {
          <span class="pl-smi">MotorDTO</span> motorDTO <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">MotorDTO</span>();
          motorDTO<span class="pl-k">.</span>setId(motor<span class="pl-k">.</span>getId());
          <span class="pl-k">return</span> motorDTO;
     }
}</pre></div>

<p>In the previous example we are creating a new CarDTO, maybe we want to return this value from an API and hide some fields, this scenario is the most common, we create a factory for each class, but this work can be boring and very difficult to give support, <strong>why?</strong>, imagine the next scenario; we want to display the all cars but we need to display only the model and we need to hide the year. Many people creates a new method in CarFactory and pass the object but ignore the line.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">CarFactory</span> {

     <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">CarFactory</span> instance <span class="pl-k">=</span> <span class="pl-c1">null</span>;

     <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">CarFactory</span> <span class="pl-en">getInstance</span>() {
          <span class="pl-k">if</span> (instance <span class="pl-k">==</span> <span class="pl-c1">null</span>) {
               instance <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">CarFactory</span>();
          }
          <span class="pl-k">return</span> instance;
     }

     <span class="pl-k">public</span> <span class="pl-smi">CarDTO</span> <span class="pl-en">create</span>(<span class="pl-smi">Car</span> <span class="pl-v">car</span>) {
          <span class="pl-smi">Motor</span> motor <span class="pl-k">=</span> <span class="pl-smi">MotorFactory</span><span class="pl-k">.</span>getInstance()<span class="pl-k">.</span>create(car<span class="pl-k">.</span>getMotor()); <span class="pl-c">// First factory created because we have a relation</span>
          <span class="pl-smi">MotorDTO</span> motorDTO <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">MotorDTO</span>(); <span class="pl-c">// Object from relation</span>
          motorDTO<span class="pl-k">.</span>setId(motor<span class="pl-k">.</span>getId());
          <span class="pl-smi">CarDTO</span> carDTO <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">CarDTO</span>(); 
          carDTO<span class="pl-k">.</span>setModel(car<span class="pl-k">.</span>getModel()); 
          carDTO<span class="pl-k">.</span>setYear(car<span class="pl-k">.</span>getYear());
          carDTO<span class="pl-k">.</span>setMotor(motorDTO);
          <span class="pl-k">return</span> carDTO;
     }

       <span class="pl-k">public</span> <span class="pl-smi">CarDTO</span> <span class="pl-en">createWithoutYear</span>(<span class="pl-smi">Car</span> <span class="pl-v">car</span>) {
          car<span class="pl-k">.</span>setYear(<span class="pl-c1">null</span>);
          <span class="pl-k">return</span> create(car);
     }
}</pre></div>

<p>As you can see we are adding a little of complexity to our factory, because can be many of possiblities, and each posiblity means a new method.</p>

<h1>
<a id="how-chameleon-will-solved-this-problem" class="anchor" href="#how-chameleon-will-solved-this-problem" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How <strong>chameleon</strong> will solved this problem?</h1>

<p>As you saw in the last section we had the problem to create to many methods in a factory, the propose to chameleon is manage this creation using a similar sintax as SQL, we can use this query and select the fields that we want and ignore the all complexity of object creation.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">interface</span> <span class="pl-en">PlaceDTORepository</span> {
     <span class="pl-k">@Query</span>(<span class="pl-s"><span class="pl-pds">"</span>SELECT C.model, C.year, C.id, M.id FROM Car c JOIN Motor M<span class="pl-pds">"</span></span>)
     <span class="pl-k">Set&lt;<span class="pl-smi">PlaceDTO</span>&gt;</span> <span class="pl-en">fetchCollection</span>(<span class="pl-k">Set&lt;<span class="pl-smi">Car</span>&gt;</span> <span class="pl-v">cars</span>);
}</pre></div>

<p>As you saw the only thing that we need is to create a simple interface, add the expected result and the columns that we want to display.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">interface</span> <span class="pl-en">CarDTORepository</span> {
     <span class="pl-k">@Query</span>(<span class="pl-s"><span class="pl-pds">"</span>SELECT C.model, C.year, C.id, M.id FROM Car c JOIN Motor M<span class="pl-pds">"</span></span>)
     <span class="pl-k">Set&lt;<span class="pl-smi">PlaceDTO</span>&gt;</span> <span class="pl-en">fetchCollection</span>(<span class="pl-k">Set&lt;<span class="pl-smi">Car</span>&gt;</span> <span class="pl-v">cars</span>);

     <span class="pl-k">@Query</span>(<span class="pl-s"><span class="pl-pds">"</span>SELECT C.model, C.id, M.id FROM Car c JOIN Motor M<span class="pl-pds">"</span></span>)
     <span class="pl-k">Set&lt;<span class="pl-smi">PlaceDTO</span>&gt;</span> <span class="pl-en">fetchCollectionWithoutCarYear</span>(<span class="pl-k">Set&lt;<span class="pl-smi">Car</span>&gt;</span> <span class="pl-v">cars</span>);
}</pre></div>

<p>And to call out repository we need to inject our class in the desire place.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">PlaceController</span> {

     <span class="pl-k">@Resource</span> <span class="pl-k">private</span> <span class="pl-smi">CarDTORepository</span> carDTORepository;

     <span class="pl-k">public</span> <span class="pl-k">Set&lt;<span class="pl-smi">PlaceDTO</span>&gt;</span> <span class="pl-en">getList</span>() {
          <span class="pl-k">Set&lt;<span class="pl-smi">Car</span>&gt;</span> cars <span class="pl-k">=</span> someMethodRetrieveAJPACollection(<span class="pl-c1">...</span>);
          <span class="pl-k">return</span> carDTORepository<span class="pl-k">.</span>fetchCollection(cars);
     }
}</pre></div>

<p>As you can see we are not working any more with factories, and the Chameleon framework deal with the object creations.</p>

<h1>
<a id="dependencies" class="anchor" href="#dependencies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dependencies</h1>

<ul>
<li>spring-aop 4.2.5.RELEASE</li>
<li>spring-beans 4.2.4.RELEASE</li>
<li>spring-context 4.2.4.RELEASE</li>
<li>spring-aop 4.2.5.RELEASE</li>
<li>aspectjweaver 1.8.8</li>
<li>aspectjrt 1.8.8</li>
<li>hibernate-core 5.1.0.Final</li>
</ul>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/JJaraM">JJaraM</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
